"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4070],{26707:function(e,t,i){i.r(t),i.d(t,{default:function(){return D}});var n=i(47689),l=i.n(n),o=i(79868),a=i(47050),s=i(5696),r=i(23433),c=i(32265),u=i(9244),p=i(96148),d=i(39843);const g=e=>{const{allOptionsAndValues:t,allRanges:i,selections:n,compatibleValues:l,compatibleRanges:o}=e,a=Object.assign({},n);return Object.entries(l).forEach((e=>{let[i,n]=e;!a[`${i}`]&&t[`${i}`]&&1===n.length&&(a[`${i}`]=l[`${i}`][0])})),Object.entries(o).forEach((e=>{let[t,n]=e;!a[`${t}`]&&i[`${t}`]&&1===n.length&&n[0].minimum===n[0].maximum&&(a[`${t}`]=String(n[0].minimum))})),a};var m=i(23262),y=i(44631),b=i(61856),O=i(99944),f=i(8465),v=i(99194);var D=e=>{const{customData:{flow:{type:t,url:i,context:D},isPrimaryCta:C,buttonIndex:S,showDescription:A,isDesignUploaded:w}}=e,{pluginData:E}=(0,n.useContext)(y.t),{locale:_,mpv:h,ctaOverrideEntries:x,tenant:U,productBuilderOptions:V}=(0,n.useContext)(a.FD),{studioDocumentUrl:k}=(0,v.A)(),{selections:R,selectedQuantity:$,clientSideStateInitialized:I,initialSelections:L,initialQuantity:j}=(0,n.useContext)(s.z),{compatibleValues:P,compatibleRanges:B,temporarilyOutOfStock:F,prices:M,initialPrices:T}=(0,n.useContext)(r.Y),{0:q,1:K}=(0,n.useState)(i||""),{isMobile:N}=(0,O.t)((0,o.OO)()),Q=!F&&!!q,{actualCtaText:z,actualCtaDescription:H,actualCtaIcon:G}=(0,b.M)(E,x,t,w,C),J=(0,n.useCallback)((e=>(0,b.k)({event:e,mpv:h,selections:R||{},initialSelections:L,pageSection:f.O.pageSection,position:S+1,url:q,linkType:t,initialQuantity:j,selectedQuantity:$,prices:M,productBuilderOptions:V,initialPrices:T,flowContexts:D,isDesignUploaded:w})),[h,R,L,f.O,S,q,t,j,$,M,V,T,b.k]);return(0,n.useEffect)((()=>{let e=!0;return I&&i?(async function(){if(i.includes("gallery.vistaprint"))try{var t;const n=await(async e=>{const{tenant:t,locale:i,mpv:n,selections:l,quantity:o,categories:a,logError:s=!0,compatibleValues:r,compatibleRanges:m,isMobile:y,studioDocumentUrl:b}=e,O=new u.j(n).getAllOptionsAndValues(),f=new u.j(n).getAllRanges(),v=g({allOptionsAndValues:O,allRanges:f,selections:l,compatibleValues:r,compatibleRanges:m}),D=await(0,p.Th)({tenant:t,culture:i,flowAction:"browsedesigns",productKey:n.coreProductId,version:n.version,optionValues:v,quantity:o,optimizelyEndUserId:(0,d.F)(),isMobile:y,urlTokens:{documentUrl:b}});let C=null==D?void 0:D.url;return C?C=C.replace("&categories={galleryCategories}",a&&a.length>0?`&categories=${a.join(",")}`:""):s&&c.V.instance.error(`Failed to construct gallery url with galleries: ${JSON.stringify({locale:i,mpvId:n.mpvId,selections:l,quantity:o,finalUrl:C})}`),C})({tenant:U,locale:_,mpv:h,selections:R||{},compatibleValues:P,compatibleRanges:B,quantity:$,categories:(null==x||null===(t=x.gallery)||void 0===t?void 0:t.categories)||[],logError:!1,isMobile:N,studioDocumentUrl:k});e&&K(n||i)}catch(n){console.error("Failed to download Gallery URL",n)}else e&&K(i)}(),()=>e=!1):()=>{}}),[h,_,R,$,I,i,N]),l().createElement(m.F,{onClickHandler:J,disabled:!Q,linkProperties:{href:q,openInNewTab:!1},buttonKey:t,text:z,description:A?H:"",iconComponent:G,pageSection:f.O.pageSection,textButtonProps:{skin:C?"primary":"secondary"},position:S})}}}]);
//# sourceMappingURL=components-Ctas-GalleryCta-8694b5e3f6431d3392c2.js.map